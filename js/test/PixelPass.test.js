const {decode, generateQRCode, generateQRData, getCWT} = require("../src");
const {expect} = require("expect");
const {ECC} = require("../src/types/ECC");

test("should return decoded data for given QR data", () => {
    const data = "NCFKVPV0QSIP600GP5L0";
    const expected = "hello";

    const actual = decode(data);
    expect(actual).toBe(expected);
});

test("should return decoded data for given QR data in cbor", () => {
    const data = "NCFHPE/Q6:96+963Y6:96P563H0 %2DH0";
    const expected = '{"temp":15}';

    const actual = decode(data);
    expect(actual).toBe(expected);
});

test("should throw error if given data is null or undefined for encoding", () => {
    expect(() => generateQRData(null)).toThrowError(
        "Cannot read properties of null (reading 'length')"
    );
    expect(() => generateQRData(undefined)).toThrowError(
        "Cannot read properties of undefined (reading 'length')"
    );
});
test("should throw error if given data is invalid for decoding", () => {
    expect(() => decode("NCFKVPV0QSIP600GP5L00")).toThrowError(
        "incorrect data check"
    );
});
test("should throw error if given data is null or undefined", () => {
    expect(() => decode(null)).toThrowError(
        "utf8StringArg is null or undefined."
    );
    expect(() => decode(undefined)).toThrowError(
        "utf8StringArg is null or undefined."
    );
});
test("should throw error if given data length is bad", () => {
    expect(() => decode("1")).toThrowError("utf8StringArg has incorrect length.");
    expect(() => decode("1234")).toThrowError(
        "utf8StringArg has incorrect length."
    );
});
test("should throw error if given data is invalid", () => {
    expect(() => decode("^1")).toThrowError("Invalid character at position 0.");
    expect(() => decode("1^")).toThrowError("Invalid character at position 1.");
    expect(() => decode("0123456789^")).toThrowError(
        "Invalid character at position 10."
    );
});
test("should return encoded QR data for data", () => {
    const expected = "NCFKVPV0QSIP600GP5L0";
    const data = "hello";

    const actual = generateQRData(data);
    expect(actual).toBe(expected);
});

test("should return encoded QR data for data with header", () => {
    const expected = "mockHeader://" + "NCFKVPV0QSIP600GP5L0";
    const data = "hello";

    const actual = generateQRData(data, "mockHeader://");
    expect(actual).toBe(expected);
});
test("should return base64 encoded QR for given data", async () => {
    const data = "hello";
    const expected =
        "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAYAAAB4sfmlAAAAAklEQVR4AewaftIAAAUpSURBVO3BQY5bCw4EsCrB97+yJvvePH14YKdDsvtHAA4mAEcTgKMJwNEE4GgCcDQBOJoAHE0AjiYARxOAownA0QTgaAJwNAE4mgAcTQCOJgBHE4CjCcDRBOBoAnA0ATiaABxNAI4mAEcTgKMJwNEE4GgCcPTKh7QNP+1uPqFtntjdPNE2T+xunmgbftrdfMIE4GgCcDQBOJoAHE0AjiYARxOAownA0QTg6JUvt7v5DdrmndrmnXY3v8Hu5jdom282ATiaABxNAI4mAEcTgKMJwNEE4GgCcDQBOHrll2ibT9jdfMLu5p3a5p12N9+sbT5hd/MbTACOJgBHE4CjCcDRBOBoAnA0ATiaABxNAI5e4Vdrmyd2N+/UNk/sbvj7TACOJgBHE4CjCcDRBOBoAnA0ATiaABxNAI5e4a/UNu/UNk/sbmACcDQBOJoAHE0AjiYARxOAownA0QTgaAJw9Movsbv5l+xuPqFtntjdfLPdDf/dBOBoAnA0ATiaABxNAI4mAEcTgKMJwNEE4OiVL9c2/NQ2T+xunmibJ3Y3T7TNE7ubd2ob/v8mAEcTgKMJwNEE4GgCcDQBOJoAHE0AjiYAR90/wj+vbT5hd8PfZwJwNAE4mgAcTQCOJgBHE4CjCcDRBOBoAnD0yoe0zRO7myfa5ondzRNt88Tu5om2eWJ38812N0+0zTdrmyd2N+/UNk/sbr7ZBOBoAnA0ATiaABxNAI4mAEcTgKMJwNEE4Kj7Rz6gbd5pd/NE2zyxu/mEtnlid/NE2zyxu3mibf4lu5tPaJsndjefMAE4mgAcTQCOJgBHE4CjCcDRBOBoAnA0ATh65cvtbp5om09om09omyd2N0+0zSfsbp5om09oG36aABxNAI4mAEcTgKMJwNEE4GgCcDQBOJoAHHX/CD+0zTvtbp5omyd2N9+sbZ7Y3bxT27zT7oafJgBHE4CjCcDRBOBoAnA0ATiaABxNAI4mAEev/GPa5ondzTu1zTu1zRO7m3dqm99gd/PN2uaJ3c0nTACOJgBHE4CjCcDRBOBoAnA0ATiaABxNAI66f4S/Ttv8Brubd2qbd9rdPNE277S7+WYTgKMJwNEE4GgCcDQBOJoAHE0AjiYARxOAo+4f+YC24afdzSe0zRO7m09omyd2N+/UNk/sbp5om3fa3XzCBOBoAnA0ATiaABxNAI4mAEcTgKMJwNEE4OiVL7e7+Q3a5hPa5p3a5hN2N0+0zRO7myd2N/w0ATiaABxNAI4mAEcTgKMJwNEE4GgCcDQBOHrll2ibT9jdfELbPLG7eae24b/b3fwGE4CjCcDRBOBoAnA0ATiaABxNAI4mAEcTgKNX+Cvtbp5omyd2N++0u3mibZ5omyd2N+/UNk/sbp5omyd2N99sAnA0ATiaABxNAI4mAEcTgKMJwNEE4GgCcPQKf6W2eae2eae2eWJ380Tb/Aa7myfa5ondzSdMAI4mAEcTgKMJwNEE4GgCcDQBOJoAHE0Ajl75JXY3/5LdzSe0zRO7myfa5ondzTu1zSe0zW8wATiaABxNAI4mAEcTgKMJwNEE4GgCcDQBOHrly7UNP7XNJ+xu3ml380TbPLG7eWJ38wm7myfa5ptNAI4mAEcTgKMJwNEE4GgCcDQBOJoAHE0Ajrp/BOBgAnA0ATiaABxNAI4mAEcTgKMJwNEE4GgCcDQBOJoAHE0AjiYARxOAownA0QTgaAJwNAE4mgAcTQCOJgBHE4CjCcDRBOBoAnA0ATiaABxNAI4mAEf/A4+rCzKLi4oKAAAAAElFTkSuQmCC";

    const actual = await generateQRCode(data, ECC.M);
    expect(actual).toBe(expected);
});

test("should return base64 encoded QR for given data with header", async () => {
    const data = "hello";
    const header = "mockHeader://";
    const expected =
        "data:image/png;base64,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";

    const actual = await generateQRCode(data, ECC.M, header);
    expect(actual).toBe(expected);
});

test("should return CWT  for given data with map", async () => {
    const encKey = {
        k: Buffer.from(
            "403697de87af64611c1d32a05dab0fe1fcb715a86ab435f1ec99192d79569388",
            "hex"
        ),
        kid: "Symmetric256",
    };
    const alg = "HS256/64";
    const data = {name: "Jhon", id: "207", l_name: "Honay"};
    const map = {id: 1, name: 2, l_name: 3};
    const expected =
        "d18443a10104a1044c53796d6d6574726963323536b818613018a161311863613218316133183661341839613518a3613602613718646138184a61391868623130186f623131186e6231320162313318636231341832623135183062313618376231370362313818656231391848623230186f623231186e6232321861623233187948755731e998385fe5";

    const actual = await getCWT(data, map, encKey, alg);
    expect(actual).toBe(expected);
});

test("should return CWT  for given data with map for claim 169 semantics", async () => {
    const encKey = {
        k: Buffer.from(
            "403697de87af64611c1d32a05dab0fe1fcb715a86ab435f1ec99192d79569388",
            "hex"
        ),
        kid: "Symmetric256",
    };
    const alg = "HS256/64";

    const data = {
        id: "11110000324013",
        version: "1.0",
        language: "EN",
        fullName: "Peter M Jhon",
        firstName: "Peter",
        middleName: "M",
        lastName: "Jhon",
        dob: "19880102",
        gender: 1,
        address: "New City, METRO LINE, PA",
        email: "peter@example.com",
        phone: "+1 234-567",
        nationality: "US",
        maritalStatus: 2,
        guardian: "Jhon Honai",
        binaryImage:
            "03CBABDF83D068ACB5DE65B3CDF25E0036F2C546CB90378C587A076E7A759DFD27CA7872B6CDFF339AEAACA61A6023FD1D305A9B4F33CAA248CEDE38B67D7C915C59A51BB4E77D10077A625258873183F82D65F4C482503A5A01F41DEE612C3542E5370987815E592B8EA2020FD3BDDC747897DB10237EAD179E55B441BC6D8BAD07CE535129CF8D559445CC3A29D746FBF1174DE2E7C0F3439BE7DBEA4520CF88825AAE6B1F291A746AB8177C65B2A459DD19BD32C0C3070004B85C1D63034707CC690AB0BA023350C8337FC6894061EB8A714A8F22FE2365E7A904C72DEC9746ABEA1A3296ECACD1A40450794EDCD2B34844E7C19EB7FB1A4AF3B05C3B374BD2941603F72D3F9A62EAB9A2FDAEEEEC8EE6E350F8A1863C0A0AB1B4058D154559A1CD5133EFCF682ABC339960819C9427889D60380B635A7D21D017974BBA57798490F668ADD86DA58125D9C4C1202CA1308F7734E43E8F77CEB0AF968A8F8B88849F9B98B26620399470ED057E7931DED82876DCA896A30D0031A8CBD7B9EDFDF16C15C6853F4F8D9EEC09317C84EDAE4B349FE54D23D8EC7DC9BB9F69FD7B7B23383B64F22E25F",
        binaryImageFormat: 2,
        bestQualityFingers: [1, 2],
    };
    const map = {
        id: 1,
        version: 2,
        language: 3,
        fullName: 4,
        firstName: 5,
        middleName: 6,
        lastName: 7,
        dob: 8,
        gender: 9,
        address: 10,
        email: 11,
        phone: 12,
        nationality: 13,
        maritalStatus: 14,
        guardian: 15,
        binaryImage: 16,
        binaryImageFormat: 17,
        bestQualityFingers: 18,
    };

    const expected =
        "d18443a10104a1044c53796d6d6574726963323536b903f0613018a161311863613218316133183661341839613518b26136016137186e61381831613918316231301831623131183162313218306231331830623134183062313518306231361833623137183262313818346231391830623230183162323118336232320262323318636232341831623235182e62323618306232370362323818626232391845623330184e62333104623332186c623333185062333418656233351874623336186562333718726233381820623339184d6234301820623431184a6234321868623433186f623434186e62343505623436186562343718506234381865623439187462353018656235311872623532066235331861623534184d623535076235361864623537184a6235381868623539186f623630186e6236310862363218686236331831623634183962363518386236361838623637183062363818316236391830623730183262373109623732016237330a62373418786237351818623736184e6237371865623738187762373918206238301843623831186962383218746238331879623834182c6238351820623836184d623837184562383818546238391852623930184f6239311820623932184c6239331849623934184e6239351845623936182c623937182062393818506239391841633130300b63313031187163313032187063313033186563313034187463313035186563313036187263313037184063313038186563313039187863313130186163313131186d63313132187063313133186c63313134186563313135182e63313136186363313137186f63313138186d633131390c63313230186a63313231182b63313232183163313233182063313234183263313235183363313236183463313237182d633132381835633132391836633133301837633133310d633133321862633133331855633133341853633133350e6331333602633133370f63313338186a63313339184a63313430186863313431186f63313432186e63313433182063313434184863313435186f63313436186e6331343718616331343818696331343910633135301879633135310363313532185163313533183063313534183363313535184363313536184263313537184163313538184263313539184463313630184663313631183863313632183363313633184463313634183063313635183663313636183863313637184163313638184363313639184263313730183563313731184463313732184563313733183663313734183563313735184263313736183363313737184363313738184463313739184663313830183263313831183563313832184563313833183063313834183063313835183363313836183663313837184663313838183263313839184363313930183563313931183463313932183663313933184363313934184263313935183963313936183063313937183363313938183763313939183863323030184363323031183563323032183863323033183763323034184163323035183063323036183763323037183663323038184563323039183763323130184163323131183763323132183563323133183963323134184463323135184663323136184463323137183263323138183763323139184363323230184163323231183763323232183863323233183763323234183263323235184263323236183663323237184363323238184463323239184663323330184663323331183363323332183363323333183963323334184163323335184563323336184163323337184163323338184363323339184163323430183663323431183163323432184163323433183663323434183063323435183263323436183363323437184663323438184463323439183163323530184463323531183363323532183063323533183563323534184163323535183963323536184263323537183463323538184663323539183363323630183363323631184363323632184163323633184163323634183263323635183463323636183863323637184363323638184563323639184463323730184563323731183363323732183863323733184263323734183663323735183763323736184463323737183763323738184363323739183963323830183163323831183563323832184363323833183563323834183963323835184163323836183563323837183163323838184263323839184263323930183463323931184563323932183763323933183763323934184463323935183163323936183063323937183063323938183763323939183763333030184163333031183663333032183263333033183563333034183263333035183563333036183863333037183863333038183763333039183363333130183163333131183863333132183363333133184663333134183863333135183263333136184463333137183663333138183563333139184663333230183463333231184363333232183463333233183863333234183263333235183563333236183063333237183363333238184163333239183563333330184163333331183063333332183163333333184663333334183463333335183163333336184463333337184563333338184563333339183663333430183163333431183263333432184363333433183363333434183563333435183463333436183263333437184563333438183563333439183363333530183763333531183063333532183963333533183863333534183763333535183863333536183163333537183563333538184563333539183563333630183963333631183263333632184263333633183863333634184563333635184163333636183263333637183063333638183263333639183063333730184663333731184463333732183363333733184263333734184463333735184463333736184363333737183763333738183463333739183763333830183863333831183963333832183763333833184463333834184263333835183163333836183063333837183263333838183363333839183763333930184563333931184163333932184463333933183163333934183763333935183963333936184563333937183563333938183563333939184263343030183463343031183463343032183163343033184263343034184363343035183663343036184463343037183863343038184263343039184163343130184463343131183063343132183763343133184363343134184563343135183563343136183363343137183563343138183163343139183263343230183963343231184363343232184663343233183863343234184463343235183563343236183563343237183963343238183463343239183463343330183563343331184363343332184363343333183363343334184163343335183263343336183963343337184463343338183763343339183463343430183663343431184663343432184263343433184663343434183163343435183163343436183763343437183463343438184463343439184563343530183263343531184563343532183763343533184363343534183063343535184663343536183363343537183463343538183363343539183963343630184263343631184563343632183763343633184463343634184263343635184563343636184163343637183463343638183563343639183263343730183063343731184363343732184663343733183863343734183863343735183863343736183263343737183563343738184163343739184163343830184563343831183663343832184263343833183163343834184663343835183263343836183963343837183163343838184163343839183763343930183463343931183663343932184163343933184263343934183863343935183163343936183763343937183763343938184363343939183663353030183563353031184263353032183263353033184163353034183463353035183563353036183963353037184463353038184463353039183163353130183963353131184263353132184463353133183363353134183263353135184363353136183063353137184363353138183363353139183063353230183763353231183063353232183063353233183063353234183463353235184263353236183863353237183563353238184363353239183163353330184463353331183663353332183363353333183063353334183363353335183463353336183763353337183063353338183763353339184363353430184363353431183663353432183963353433183063353434184163353435184263353436183063353437184263353438184163353439183063353530183263353531183363353532183363353533183563353534183063353535184363353536183863353537183363353538183363353539183763353630184663353631184363353632183663353633183863353634183963353635183463353636183063353637183663353638183163353639184563353730184263353731183863353732184163353733183763353734183163353735183463353736184163353737183863353738184663353739183263353830183263353831184663353832184563353833183263353834183363353835183663353836183563353837184563353838183763353839184163353930183963353931183063353932183463353933184363353934183763353935183263353936184463353937184563353938184363353939183963363030183763363031183463363032183663363033184163363034184263363035184563363036184163363037183163363038184163363039183363363130183263363131183963363132183663363133184563363134184363363135184163363136184363363137184463363138183163363139184163363230183463363231183063363232183463363233183563363234183063363235183763363236183963363237183463363238184563363239184463363330184363363331184463363332183263363333184263363334183363363335183463363336183863363337183463363338183463363339184563363430183763363431184363363432183163363433183963363434184563363435184263363436183763363437184663363438184263363439183163363530184163363531183463363532184163363533184663363534183363363535184263363536183063363537183563363538184363363539183363363630184263363631183363363632183763363633183463363634184263363635184463363636183263363637183963363638183463363639183163363730183663363731183063363732183363363733184663363734183763363735183263363736184463363737183363363738184663363739183963363830184163363831183663363832183263363833184563363834184163363835184263363836183963363837184163363838183263363839184663363930184463363931184163363932184563363933184563363934184563363935184563363936184363363937183863363938184563363939184563373030183663373031184563373032183363373033183563373034183063373035184663373036183863373037184163373038183163373039183863373130183663373131183363373132184363373133183063373134184163373135183063373136184163373137184263373138183163373139184263373230183463373231183063373232183563373233183863373234184463373235183163373236183563373237183463373238183563373239183563373330183963373331184163373332183163373333184363373334184463373335183563373336183163373337183363373338183363373339184563373430184663373431184363373432184663373433183663373434183863373435183263373436184163373437184263373438184363373439183363373530183363373531183963373532183963373533183663373534183063373535183863373536183163373537183963373538184363373539183963373630183463373631183263373632183763373633183863373634183863373635183963373636184463373637183663373638183063373639183363373730183863373731183063373732184263373733183663373734183363373735183563373736184163373737183763373738184463373739183263373830183163373831184463373832183063373833183163373834183763373835183963373836183763373837183463373838184263373839184263373930184163373931183563373932183763373933183763373934183963373935183863373936183463373937183963373938183063373939184663383030183663383031183663383032183863383033184163383034184463383035184463383036183863383037183663383038184463383039184163383130183563383131183863383132183163383133183263383134183563383135184463383136183963383137184363383138183463383139184363383230183163383231183263383232183063383233183263383234184363383235184163383236183163383237183363383238183063383239183863383330184663383331183763383332183763383333183363383334183463383335184563383336183463383337183363383338184563383339183863383430184663383431183763383432183763383433184363383434184563383435184263383436183063383437184163383438184663383439183963383530183663383531183863383532184163383533183863383534184663383535183863383536184263383537183863383538183863383539183863383630183463383631183963383632184663383633183963383634184263383635183963383636183863383637184263383638183263383639183663383730183663383731183263383732183063383733183363383734183963383735183963383736183463383737183763383738183063383739184563383830184463383831183063383832183563383833183763383834184563383835183763383836183963383837183363383838183163383839184463383930184563383931184463383932183863383933183263383934183863383935183763383936183663383937184463383938184363383939184163393030183863393031183963393032183663393033184163393034183363393035183063393036184463393037183063393038183063393039183363393130183163393131184163393132183863393133184363393134184263393135184463393136183763393137184263393138183963393139184563393230184463393231184663393232184463393233184663393234183163393235183663393236184363393237183163393238183563393239184363393330183663393331183863393332183563393333183363393334184663393335183463393336184663393337183863393338184463393339183963393430184563393431184563393432184363393433183063393434183963393435183363393436183163393437183763393438184363393439183863393530183463393531184563393532184463393533184163393534184563393535183463393536184263393537183363393538183463393539183963393630184663393631184563393632183563393633183463393634184463393635183263393636183363393637184463393638183863393639184563393730184363393731183763393732184463393733184363393734183963393735184263393736184263393737183963393738184663393739183663393830183963393831184663393832184463393833183763393834184263393835183763393836184263393837183263393838183363393839183363393930183863393931183363393932184263393933183663393934183463393935184663393936183263393937183263393938184563393939183264313030301835643130303118466431303032116431303033026431303034126431303035188264313030360164313030370248f63d5d843fbd0262";

    const actual = await getCWT(data, map, encKey, alg);
    expect(actual).toBe(expected);
});
